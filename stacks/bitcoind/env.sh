#!/bin/bash

set -e

export IMAGE_NAME="bcm-bitcoin-core"

export TIER_NAME="bitcoin$BCM_ACTIVE_CHAIN"
export STACK_NAME="bitcoind"
export SERVICE_NAME="bitcoind"

# export STACK_DOCKER_VOLUMES="cli wallet cookie data blocks"
export DOCKER_VOLUME_NAME="bitcoind-$BCM_ACTIVE_CHAIN""_data"

# defaults are for mainnet
BITCOIND_RPCNET_SUBNET="172.16.50.0/27"
BITCOIND_RPCNET_IP="172.16.50.6"
BITCOIND_ONIONNET_SUBNET="172.16.100.0/27"
BITCOIND_ONIONNET_IP="172.16.100.6"
BITCOIND_RPC_PORT=8332
BITCOIND_ZMQ_BLOCK_PORT=9332
BITCOIND_ZMQ_TX_PORT=9331
if [[ $BCM_ACTIVE_CHAIN == "testnet" ]]; then
    BITCOIND_RPCNET_SUBNET="172.16.50.32/27"
    BITCOIND_RPCNET_IP="172.16.50.55"
    BITCOIND_ONIONNET_SUBNET="172.16.100.32/27"
    BITCOIND_ONIONNET_IP="172.16.100.55"
    BITCOIND_RPC_PORT=18332
    BITCOIND_ZMQ_BLOCK_PORT=19332
    BITCOIND_ZMQ_TX_PORT=19331
elif [[ $BCM_ACTIVE_CHAIN == "regtest" ]]; then
    BITCOIND_RPCNET_SUBNET="172.16.50.64/27"
    BITCOIND_RPCNET_IP="172.16.50.67"
    BITCOIND_ONIONNET_SUBNET="172.16.100.64/27"
    BITCOIND_ONIONNET_IP="172.16.100.67"
    BITCOIND_RPC_PORT=28332
    BITCOIND_ZMQ_BLOCK_PORT=29332
    BITCOIND_ZMQ_TX_PORT=29331
fi

export BITCOIND_RPCNET_SUBNET="$BITCOIND_RPCNET_SUBNET"
export BITCOIND_RPCNET_IP="$BITCOIND_RPCNET_IP"
export BITCOIND_ONIONNET_IP="$BITCOIND_ONIONNET_IP"
export BITCOIND_RPC_PORT="$BITCOIND_RPC_PORT"
export BITCOIND_ZMQ_BLOCK_PORT="$BITCOIND_ZMQ_BLOCK_PORT"
export BITCOIND_ZMQ_TX_PORT="$BITCOIND_ZMQ_TX_PORT"
export BITCOIND_ONIONNET_SUBNET="$BITCOIND_ONIONNET_SUBNET"
